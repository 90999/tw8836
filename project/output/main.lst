C51 COMPILER V9.51   MAIN                                                                  07/19/2013 23:45:30 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\output\main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c LARGE OPTIMIZE(7,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\output\mai
                    -n.lst) TABS(2) OBJECT(.\output\main.obj)

line level    source

   1          /*********************************************************************************************************
   2          **                                       Small RTOS(51)
   3          **                                   The Real-Time Kernel(For Keil c51)
   4          **
   5          **                                  (c) Copyright 2002-2003, chenmingji
   6          **                                           All Rights Reserved
   7          **
   8          **                                                  V1.12.0
   9          **
  10          **
  11          **--------------文件信息--------------------------------------------------------------------------------
  12          **文   件   名: serial.c
  13          **创   建   人: 陈明计
  14          **最后修改日期: 2002年12月30日
  15          **描        述: 为信号量编制的测试代码。
  16          **
  17          **--------------历史版本信息----------------------------------------------------------------------------
  18          ** 创建人: 陈明计
  19          ** 版  本: V1.10
  20          ** 日　期: 2002年9月1日
  21          ** 描　述: 原始版本
  22          **
  23          **------------------------------------------------------------------------------------------------------
  24          ** 修改人: 陈明计
  25          ** 版  本: V1.11.0
  26          ** 日　期: 2003年12月2日
  27          ** 描　述: 删除TaskE代码
  28          **
  29          **------------------------------------------------------------------------------------------------------
  30          ** 修改人: 陈明计
  31          ** 版  本: V1.12.0
  32          ** 日　期: 2003年12月30日
  33          ** 描　述: 无变化
  34          **
  35          **--------------当前版本修订------------------------------------------------------------------------------
  36          ** 修改人: 
  37          ** 日　期:
  38          ** 描　述:
  39          **
  40          **------------------------------------------------------------------------------------------------------
  41          ********************************************************************************************************/
  42          #include "config.h"
  43          #include "cpu.h"
  44          
  45          void TaskA(void);
  46          void TaskB(void);
  47          void TaskC(void);
  48          void TaskD(void);
  49          
  50          void putch(uint8 Data)
  51          {
  52   1          uint8 i,j;
  53   1      
  54   1          SBUF = Data;
C51 COMPILER V9.51   MAIN                                                                  07/19/2013 23:45:30 PAGE 2   

  55   1          i = 2048 / 256;
  56   1          j = 2048 % 256;
  57   1          do
  58   1          {
  59   2              do
  60   2              {
  61   3              } while (--j !=0);
  62   2          } while (--i != 0);    
  63   1      }
  64          
  65          void init_task(void)
  66          {
  67   1        init_cpu();
  68   1        EA = 1;
  69   1        
  70   1        while (1)
  71   1        {
  72   2          putch('x');
  73   2          OSWait(K_TMO, 100);   
  74   2        }
  75   1      }
  76          
  77          void main(void)
  78          {
  79   1          OSInit();
  80   1        
  81   1          OSTaskCreate(init_task, NULL, 0);
  82   1      //    OSTaskCreate(TaskA, NULL, 0);
  83   1      //    OSTaskCreate(TaskB, NULL, 1);
  84   1      //    OSTaskCreate(TaskC, NULL, 2);
  85   1      //    OSTaskCreate(TaskD, NULL, 3);
  86   1      
  87   1          while(1)
  88   1          {
  89   2            ;
  90   2      //        PCON = PCON | 0x01;                     /* CPU进入休眠状态 */
  91   2          }
  92   1      }
  93          
  94          void TaskA(void)
  95          {
  96   1        init_cpu();
  97   1      /*
  98   1        TMOD = (TMOD & 0XF0) | 0X01;
  99   1        TL0 = 0x0;
 100   1        TH0 = 0x0;
 101   1        TR0 = 1;
 102   1        ET0 = 1;
 103   1        TF0 = 0;
 104   1      */  
 105   1        EA = 1;
 106   1          
 107   1        OSSemCreate(0,1);
 108   1          while (1)
 109   1          {
 110   2              OSSemPend(0,0);
 111   2              putch('A');
 112   2              putch('0');
 113   2              putch('1');
 114   2              putch('2');
 115   2              putch('3');
 116   2              putch('\n');
C51 COMPILER V9.51   MAIN                                                                  07/19/2013 23:45:30 PAGE 3   

 117   2              OSSemPost(0);
 118   2              OSWait(K_TMO,TL0);
 119   2          } 
 120   1      }
 121          
 122          void TaskB(void)
 123          {
 124   1          while (1)
 125   1          {
 126   2              OSSemPend(0,0);
 127   2              putch('B');
 128   2              putch('0');
 129   2              putch('1');
 130   2              putch('2');
 131   2              putch('3');
 132   2              putch('\n');
 133   2              OSSemPost(0);
 134   2              OSWait(K_TMO,TL0);
 135   2          } 
 136   1      }
 137          
 138          void TaskC(void)
 139          {
 140   1          while (1)
 141   1          {
 142   2              OSSemPend(0,0);
 143   2              putch('C');
 144   2              putch('0');
 145   2              putch('1');
 146   2              putch('2');
 147   2              putch('3');
 148   2              putch('\n');
 149   2              OSSemPost(0);
 150   2              OSWait(K_TMO,TL0);
 151   2          } 
 152   1      }
 153          
 154          void TaskD(void)
 155          {
 156   1          uint8 i;
 157   1          
 158   1          while (1)
 159   1          {
 160   2              OSSemPend(0,0);
 161   2              for (i = 0; i < 100; i++)
 162   2              {
 163   3                  putch('D');
 164   3                  putch('E');
 165   3                  putch('F');
 166   3                  putch('G');
 167   3                  putch(' ');
 168   3              }
 169   2              OSSemPost(0);
 170   2          } 
 171   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    259    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.51   MAIN                                                                  07/19/2013 23:45:30 PAGE 4   

   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
